<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Prayer Times - Shoib&#x27;s Space</title><meta name="description" content="The digital home of Shoibâ€™s thoughts, projects, and passions."><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://www.shoib.me/prayer-times/"><link rel="alternate" type="application/atom+xml" href="https://www.shoib.me/feed.xml" title="Shoib&#x27;s Space - RSS"><link rel="alternate" type="application/json" href="https://www.shoib.me/feed.json" title="Shoib&#x27;s Space - JSON"><meta property="og:title" content="Prayer Times"><meta property="og:image" content="https://www.shoib.me/media/website/icons8-swot-analysis-400.png"><meta property="og:image:width" content="400"><meta property="og:image:height" content="400"><meta property="og:site_name" content="Shoib's Space"><meta property="og:description" content="The digital home of Shoibâ€™s thoughts, projects, and passions."><meta property="og:url" content="https://www.shoib.me/prayer-times/"><meta property="og:type" content="article"><link rel="shortcut icon" href="https://www.shoib.me/media/website/icons8-swot-analysis-50-3.png" type="image/png"><link rel="preload" href="https://www.shoib.me/assets/dynamic/fonts/jetbrainsmono/jetbrainsmono.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="https://www.shoib.me/assets/dynamic/fonts/jetbrainsmono/jetbrainsmono-italic.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://www.shoib.me/assets/css/style.css?v=2e46e1f2fc98a3dc054c47a693e5312f"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.shoib.me/prayer-times/"},"headline":"Prayer Times","datePublished":"2025-05-29T22:11+05:00","dateModified":"2025-05-29T22:11+05:00","image":{"@type":"ImageObject","url":"https://www.shoib.me/media/website/icons8-swot-analysis-400.png","height":400,"width":400},"description":"The digital home of Shoibâ€™s thoughts, projects, and passions.","author":{"@type":"Person","name":"Muhammad Shoib","url":"https://www.shoib.me/authors/muhammad-shoib/"},"publisher":{"@type":"Organization","name":"Muhammad Shoib","logo":{"@type":"ImageObject","url":"https://www.shoib.me/media/website/icons8-swot-analysis-400.png","height":400,"width":400}}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript><style>.extlink::after {
				background-color: currentColor;
				content: "";
				display: inline-block;
				height: 16px;
				margin-left: 5px;
				position: relative;
				top: 0px;
				width: 16px;
			}
		
					.extlink.extlink-icon-1::after {
						mask-image: url("data:image/svg+xml;utf8,<svg viewBox='0 0 24 24' fill='none' stroke='%23000000' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' xmlns='http://www.w3.org/2000/svg'><path d='M15 3h6v6'/><path d='M10 14 21 3'/><path d='M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6'/></svg>");
						mask-repeat: no-repeat;
						mask-size: contain;
					}</style><style>.fi{fill:none;stroke-linecap:round;stroke-linejoin:round;vertical-align:middle}</style></head><body class="page-template"><div class="container container--center"><header class="header"><div class="header__logo"><a class="logo" href="https://www.shoib.me/"><img src="https://www.shoib.me/media/website/icons8-swot-analysis-400.png" alt="Shoib&#x27;s Space" width="400" height="400"></a></div><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://www.shoib.me/projects-and-case-studies/" target="_self">Projects &amp; Case Studies</a></li><li><a href="https://www.shoib.me/services-and-solutions/" target="_self">Services &amp; Solutions</a></li><li><a href="https://www.shoib.me/blog-and-insights/" target="_self">Blog</a></li><li><a href="https://www.shoib.me/enter-password-to-view-content/" target="_self">Enter Password to View Content</a></li><li class="active"><a href="https://www.shoib.me/prayer-times/" target="_self">Prayer Times</a></li><li><a href="https://www.shoib.me/advanced-qibla-direction-finder/" target="_self">Advanced Qibla Direction Finder</a></li><li><a href="https://www.shoib.me/advanced-lunar-month-calculator/" target="_self">Advanced Lunar Month Calculator</a></li><li><a href="https://www.shoib.me/quran-explorer/" target="_self">ðŸ“– Quran Explorer</a></li></ul></nav></header><main class="content page"><article class="post"><header><h1 class="post__title">Prayer Times</h1></header><div class="post__entry"><div class="container"><h1>Prayer Times</h1><div class="settings-panel"><h3>Settings</h3><div class="input-group"><label for="city">City:</label> <input id="city" type="text" placeholder="e.g., London"></div><div class="input-group"><label for="country">Country:</label> <input id="country" type="text" placeholder="e.g., UK"></div><div class="input-group"><label for="method">Calc Method:</label><select><option value="2">University of Islamic Sciences, Karachi</option><option value="1">Muslim World League</option><option value="3">Islamic Society of North America (ISNA)</option><option value="4">Umm Al-Qura University, Makkah</option><option value="5">Egyptian General Authority of Survey</option><option value="7">Institute of Geophysics, University of Tehran</option><option value="8">Gulf Region</option><option value="9">Kuwait</option><option value="10">Qatar</option><option value="11">Majlis Ugama Islam Singapura, Singapore</option><option value="12">Union Organization Islamic de France</option><option value="13">Diyanet Ä°ÅŸleri BaÅŸkanlÄ±ÄŸÄ±, Turkey</option><option value="15">Dubai (unofficial)</option><option value="16">Moonsighting Committee Worldwide</option></select></div><div class="input-group"><label for="school">Asr Juristic:</label><select id="school"><option value="0">Standard (Shafii, Maliki, Hanbali)</option><option value="1">Hanafi</option></select></div><div class="button-group"><button id="fetch-city">Get by City</button> <button id="fetch-location">Get by My Location</button></div></div><div id="current-location-info" style="margin-bottom: 15px; font-style: italic; color: #555;"></div><div id="result"></div><footer><p>Prayer times provided by <a href="https://aladhan.com/" target="_blank" class="extlink extlink-icon-1" rel="noopener">AlAdhan API</a></p></footer></div><p><script>const resultDiv = document.getElementById('result');
    const cityInput = document.getElementById('city');
    const countryInput = document.getElementById('country');
    const methodSelect = document.getElementById('method');
    const schoolSelect = document.getElementById('school');
    const currentLocationInfoDiv = document.getElementById('current-location-info');

    let prayerTimingsData = null; // To store current timings
    let countdownInterval = null; // To store interval ID

    // --- Settings Management ---
    function saveSettings() {
        localStorage.setItem('prayerAppCity', cityInput.value);
        localStorage.setItem('prayerAppCountry', countryInput.value);
        localStorage.setItem('prayerAppMethod', methodSelect.value);
        localStorage.setItem('prayerAppSchool', schoolSelect.value);
    }

    function loadSettings() {
        cityInput.value = localStorage.getItem('prayerAppCity') || '';
        countryInput.value = localStorage.getItem('prayerAppCountry') || '';
        methodSelect.value = localStorage.getItem('prayerAppMethod') || '2'; // Default to Karachi
        schoolSelect.value = localStorage.getItem('prayerAppSchool') || '0'; // Default to Standard Asr
    }

    // --- UI Functions ---
    function showLoading(message = 'Loading...') {
        resultDiv.innerHTML = `<p>${message}</p>`;
        if (countdownInterval) clearInterval(countdownInterval);
        currentLocationInfoDiv.textContent = '';
    }

    function displayError(message) {
        resultDiv.innerHTML = `<p class="error-message">Error: ${message}</p>`;
        if (countdownInterval) clearInterval(countdownInterval);
    }
    
    function updateCurrentLocationInfo(info) {
        currentLocationInfoDiv.textContent = `Displaying times for: ${info}`;
    }

    // --- API Fetching ---
    async function fetchPrayerData(url, locationInfo) {
        showLoading(`Fetching prayer times for ${locationInfo}...`);
        try {
            const response = await fetch(url);
            if (!response.ok) {
                const errorData = await response.json().catch(() => null);
                throw new Error(errorData?.data || response.statusText || `HTTP error ${response.status}`);
            }
            const data = await response.json();
            if (data.code !== 200) throw new Error(data.status || data.data || 'Invalid response from API');
            
            prayerTimingsData = data.data;
            displayPrayerTimes(prayerTimingsData);
            updateCurrentLocationInfo(locationInfo);
            saveSettings(); // Save successful settings
        } catch (error) {
            console.error('API Error:', error);
            displayError(error.message);
        }
    }

    function fetchByCoordinates() {
        if (!navigator.geolocation) {
            displayError('Geolocation is not supported by this browser.');
            return;
        }
        showLoading('Getting your location...');
        navigator.geolocation.getCurrentPosition(
            (position) => {
                const latitude = position.coords.latitude;
                const longitude = position.coords.longitude;
                const method = methodSelect.value;
                const school = schoolSelect.value;
                const url = `https://api.aladhan.com/v1/timings/${Date.now()/1000}?latitude=${latitude}&longitude=${longitude}&method=${method}&school=${school}`;
                fetchPrayerData(url, `your current location (Lat: ${latitude.toFixed(2)}, Lon: ${longitude.toFixed(2)})`);
            },
            (error) => {
                displayError('Error getting location: ' + error.message);
            }
        );
    }

    function fetchByCity() {
        const city = cityInput.value.trim();
        const country = countryInput.value.trim();
        const method = methodSelect.value;
        const school = schoolSelect.value;

        if (!city || !country) {
            displayError('Please enter both City and Country.');
            return;
        }
        const url = `https://api.aladhan.com/v1/timingsByCity/${Date.now()/1000}?city=${encodeURIComponent(city)}&country=${encodeURIComponent(country)}&method=${method}&school=${school}`;
        fetchPrayerData(url, `${city}, ${country}`);
    }

    // --- Time Logic & Display ---
    function timeToMinutes(timeStr) {
        const [hours, minutes] = timeStr.split(':').map(Number);
        return hours * 60 + minutes;
    }

    function formatTimeForDisplay(timeStr) { // Basic AM/PM formatting
        let [hours, minutes] = timeStr.split(':').map(Number);
        const ampm = hours >= 12 ? 'PM' : 'AM';
        hours = hours % 12;
        hours = hours ? hours : 12; // the hour '0' should be '12'
        const minutesStr = minutes < 10 ? '0' + minutes : minutes;
        return `${hours}:${minutesStr} ${ampm}`;
    }

    function getPrayerStates() {
        if (!prayerTimingsData) return null;

        const now = new Date();
        const currentMinutes = now.getHours() * 60 + now.getMinutes();
        
        const prayerOrder = ['Fajr', 'Sunrise', 'Dhuhr', 'Asr', 'Maghrib', 'Isha'];
        const displayPrayers = prayerOrder.map(p => ({ name: p, time: prayerTimingsData.timings[p] })).filter(p => p.time);

        let nextPrayer = null;
        let currentPrayerWindow = null; // The prayer whose time has started but not ended

        // Find next prayer
        for (const prayer of displayPrayers) {
            if (timeToMinutes(prayer.time) > currentMinutes) {
                nextPrayer = prayer;
                break;
            }
        }
        // If all prayers for today passed, next is Fajr of tomorrow
        if (!nextPrayer && displayPrayers.length > 0) {
            nextPrayer = { ...displayPrayers[0], isNextDay: true }; 
        }

        // Determine current prayer window
        for (let i = 0; i < displayPrayers.length; i++) {
            const prayer = displayPrayers[i];
            const prayerStartMinutes = timeToMinutes(prayer.time);
            const nextPrayerInList = displayPrayers[i+1];
            // If it's Isha, its window lasts until midnight for this logic, or until next day's Fajr.
            // For simplicity here, if current time is past Isha, no "current prayer window" is highlighted unless it's Isha itself.
            const prayerEndMinutes = nextPrayerInList ? timeToMinutes(nextPrayerInList.time) : (prayer.name === 'Isha' ? 24*60 : prayerStartMinutes + 60) ; // Assume Isha window until midnight or next prayer
            
            if (currentMinutes >= prayerStartMinutes && currentMinutes < prayerEndMinutes) {
                 // Sunrise is not a prayer to be "in window of" for this highlighting
                if (prayer.name !== 'Sunrise') {
                    currentPrayerWindow = prayer;
                }
                break; 
            }
        }
         // If after Isha, then current prayer window could be considered Isha until next Fajr
        if(!currentPrayerWindow && displayPrayers.length > 0 && currentMinutes >= timeToMinutes(displayPrayers[displayPrayers.length - 1].time) && displayPrayers[displayPrayers.length - 1].name === "Isha"){
            currentPrayerWindow = displayPrayers[displayPrayers.length - 1];
        }


        return { displayPrayers, nextPrayer, currentPrayerWindow };
    }


    function displayPrayerTimes(data) {
        const gregorianDate = data.date.readable;
        const hijriDate = `${data.date.hijri.day} ${data.date.hijri.month.en} ${data.date.hijri.year} <span class="hijri-date">(${data.date.hijri.month.ar})</span>`;
        
        const { displayPrayers, nextPrayer, currentPrayerWindow } = getPrayerStates();
        
        if (!displayPrayers) {
            displayError("Could not process prayer times.");
            return;
        }

        resultDiv.innerHTML = `
            <h2>Prayer Times</h2>
            <p class="date-info"> ${gregorianDate} / ${hijriDate}</p>
            <div id="countdown">Initializing countdown...</div>
            <ul>
                ${displayPrayers.map(prayer => 
                    `<li class="${nextPrayer && prayer.name === nextPrayer.name ? 'next-prayer-highlight' : ''} ${currentPrayerWindow && prayer.name === currentPrayerWindow.name ? 'current-prayer-window' : ''}">
                        <span>${prayer.name}</span>
                        <span>${formatTimeForDisplay(prayer.time)}</span>
                    </li>`
                ).join('')}
            </ul>
        `;
        
        if (nextPrayer) {
            startCountdown(nextPrayer);
        } else {
            document.getElementById('countdown').innerHTML = "All prayers for the day have passed. Waiting for next day's Fajr.";
             // Potentially schedule a fetch for tomorrow's times or handle this state more gracefully
        }
    }
    
    function startCountdown(nextPrayerInfo) {
        if (countdownInterval) clearInterval(countdownInterval);
        const countdownDiv = document.getElementById('countdown');
        if (!countdownDiv) return;

        function updateCountdown() {
            const now = new Date();
            const [hours, minutes] = nextPrayerInfo.time.split(':').map(Number);
            
            const nextPrayerDateTime = new Date();
            nextPrayerDateTime.setHours(hours, minutes, 0, 0);

            if (nextPrayerInfo.isNextDay || (nextPrayerDateTime < now && nextPrayerInfo.name === "Fajr") ) { // If it's explicitly next day Fajr, or if Fajr time for today has passed
                nextPrayerDateTime.setDate(nextPrayerDateTime.getDate() + 1);
            }
            
            const diff = nextPrayerDateTime - now;

            if (diff <= 0) {
                countdownDiv.innerHTML = `Time for ${nextPrayerInfo.name}!`;
                // Re-evaluate prayer states and start next countdown
                // This will find the *new* next prayer and restart
                setTimeout(() => {
                    if(prayerTimingsData) displayPrayerTimes(prayerTimingsData); 
                }, 2000); // Short delay before refreshing
                return;
            }
            
            const h = Math.floor(diff / 3600000);
            const m = Math.floor((diff % 3600000) / 60000);
            const s = Math.floor((diff % 60000) / 1000);
            
            countdownDiv.innerHTML = `Time until ${nextPrayerInfo.name}: ${h}h ${m}m ${s}s`;
        }
        
        countdownInterval = setInterval(updateCountdown, 1000);
        updateCountdown(); // Initial call
    }

    // --- Event Listeners ---
    document.getElementById('fetch-location').addEventListener('click', fetchByCoordinates);
    document.getElementById('fetch-city').addEventListener('click', fetchByCity);
    
    // Load settings and fetch times if city/country were previously set
    window.addEventListener('load', () => {
        loadSettings();
        const lastCity = localStorage.getItem('prayerAppCity');
        const lastCountry = localStorage.getItem('prayerAppCountry');
        if (lastCity && lastCountry) {
            // To prevent auto-fetch on every load if user prefers geolocation:
            // We can add a flag, or just let them click. For now, let's auto-fetch if city/country exist.
            // Or, better: updateCurrentLocationInfo(`Last used: ${lastCity}, ${lastCountry}. Click fetch to update.`);
            // For this version, let's fetch if city/country are present
             fetchByCity();
        } else {
             resultDiv.innerHTML = "<p>Enter city/country or use your location to get prayer times.</p>";
        }
    });</script></p></div></article></main><footer class="footer"><div class="footer__inner"><div class="footer__copyright"><p><span style="color: #2dc26b;">Â© 2025 All rights reserved. This website and its content are the property of the owner</span></p></div></div></footer></div><script defer="defer" src="https://www.shoib.me/assets/js/scripts.min.js?v=c2232aa7558e9517946129d2a1b8c770"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'overlay',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script><script>(function() {
			var originalTitle = document.title;
			var timeout;
			document.addEventListener("visibilitychange", function() {
				if (document.hidden) {
					document.title = "ðŸ‘€ We miss you! Plz Come back!";
				} else {
					clearTimeout(timeout);
					document.title = "ðŸŽ‰ Welcome back!";
							setTimeout(function() {
								document.title = originalTitle;
							}, 2000);
				}
			});
		})();</script></body></html>